(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[107],{5471:(e,r,t)=>{Promise.resolve().then(t.bind(t,3838))},5132:function(e,r,t){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++)for(var s in r=arguments[t])Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);return e}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.destroyCookie=r.setCookie=r.parseCookies=void 0;var s=t(5451),a=t(7079),i=t(7273);function n(e,r){var t,o;return(null===(o=null===(t=null==e?void 0:e.req)||void 0===t?void 0:t.headers)||void 0===o?void 0:o.cookie)?s.parse(e.req.headers.cookie,r):i.isBrowser()?s.parse(document.cookie,r):{}}function c(e,r,t,n){var c,d;if(void 0===n&&(n={}),(null===(c=null==e?void 0:e.res)||void 0===c?void 0:c.getHeader)&&e.res.setHeader){if(null===(d=null==e?void 0:e.res)||void 0===d?void 0:d.finished)return console.warn('Not setting "'+r+'" cookie. Response has finished.'),console.warn("You should set cookie before res.send()"),{};var l=e.res.getHeader("Set-Cookie")||[];"string"==typeof l&&(l=[l]),"number"==typeof l&&(l=[]);var u=a.parse(l,{decodeValues:!1}),p=i.createCookie(r,t,n),g=[];u.forEach(function(e){if(!i.areCookiesEqual(e,p)){var r=s.serialize(e.name,e.value,o({encode:function(e){return e}},e));g.push(r)}}),g.push(s.serialize(r,t,n)),e.res.setHeader("Set-Cookie",g)}if(i.isBrowser()){if(n&&n.httpOnly)throw Error("Can not set a httpOnly cookie in the browser.");document.cookie=s.serialize(r,t,n)}return{}}function d(e,r,t){return c(e,r,"",o(o({},t||{}),{maxAge:-1}))}r.parseCookies=n,r.setCookie=c,r.destroyCookie=d,r.default={set:c,get:n,destroy:d}},7273:function(e,r){"use strict";var t=this&&this.__assign||function(){return(t=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++)for(var s in r=arguments[t])Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);return e}).apply(this,arguments)};function o(e,r){var t=Object.getOwnPropertyNames(e),o=Object.getOwnPropertyNames(r);if(t.length!==o.length)return!1;for(var s=0;s<t.length;s++){var a=t[s];if(e[a]!==r[a])return!1}return!0}Object.defineProperty(r,"__esModule",{value:!0}),r.areCookiesEqual=r.hasSameProperties=r.createCookie=r.isBrowser=void 0,r.isBrowser=function(){return"undefined"!=typeof window},r.createCookie=function(e,r,o){var s=o.sameSite;!0===s&&(s="strict"),(void 0===s||!1===s)&&(s="lax");var a=t(t({},o),{sameSite:s});return delete a.encode,t({name:e,value:r},a)},r.hasSameProperties=o,r.areCookiesEqual=function(e,r){var s=e.sameSite===r.sameSite;return"string"==typeof e.sameSite&&"string"==typeof r.sameSite&&(s=e.sameSite.toLowerCase()===r.sameSite.toLowerCase()),o(t(t({},e),{sameSite:void 0}),t(t({},r),{sameSite:void 0}))&&s}},5451:(e,r)=>{"use strict";r.parse=function(e,r){if("string"!=typeof e)throw TypeError("argument str must be a string");for(var o={},s=e.split(";"),a=(r||{}).decode||t,i=0;i<s.length;i++){var n=s[i],c=n.indexOf("=");if(!(c<0)){var d=n.substring(0,c).trim();if(void 0==o[d]){var l=n.substring(c+1,n.length).trim();'"'===l[0]&&(l=l.slice(1,-1)),o[d]=function(e,r){try{return r(e)}catch(r){return e}}(l,a)}}}return o},r.serialize=function(e,r,t){var a=t||{},i=a.encode||o;if("function"!=typeof i)throw TypeError("option encode is invalid");if(!s.test(e))throw TypeError("argument name is invalid");var n=i(r);if(n&&!s.test(n))throw TypeError("argument val is invalid");var c=e+"="+n;if(null!=a.maxAge){var d=a.maxAge-0;if(isNaN(d)||!isFinite(d))throw TypeError("option maxAge is invalid");c+="; Max-Age="+Math.floor(d)}if(a.domain){if(!s.test(a.domain))throw TypeError("option domain is invalid");c+="; Domain="+a.domain}if(a.path){if(!s.test(a.path))throw TypeError("option path is invalid");c+="; Path="+a.path}if(a.expires){if("function"!=typeof a.expires.toUTCString)throw TypeError("option expires is invalid");c+="; Expires="+a.expires.toUTCString()}if(a.httpOnly&&(c+="; HttpOnly"),a.secure&&(c+="; Secure"),a.sameSite)switch("string"==typeof a.sameSite?a.sameSite.toLowerCase():a.sameSite){case!0:case"strict":c+="; SameSite=Strict";break;case"lax":c+="; SameSite=Lax";break;case"none":c+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return c};var t=decodeURIComponent,o=encodeURIComponent,s=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},7079:e=>{"use strict";var r={decodeValues:!0,map:!1,silent:!1};function t(e){return"string"==typeof e&&!!e.trim()}function o(e,o){var s,a,i,n,c=e.split(";").filter(t),d=(s=c.shift(),a="",i="",(n=s.split("=")).length>1?(a=n.shift(),i=n.join("=")):i=s,{name:a,value:i}),l=d.name,u=d.value;o=o?Object.assign({},r,o):r;try{u=o.decodeValues?decodeURIComponent(u):u}catch(e){console.error("set-cookie-parser encountered an error while decoding a cookie with value '"+u+"'. Set options.decodeValues to false to disable this feature.",e)}var p={name:l,value:u};return c.forEach(function(e){var r=e.split("="),t=r.shift().trimLeft().toLowerCase(),o=r.join("=");"expires"===t?p.expires=new Date(o):"max-age"===t?p.maxAge=parseInt(o,10):"secure"===t?p.secure=!0:"httponly"===t?p.httpOnly=!0:"samesite"===t?p.sameSite=o:"partitioned"===t?p.partitioned=!0:p[t]=o}),p}function s(e,s){if(s=s?Object.assign({},r,s):r,!e)return s.map?{}:[];if(e.headers){if("function"==typeof e.headers.getSetCookie)e=e.headers.getSetCookie();else if(e.headers["set-cookie"])e=e.headers["set-cookie"];else{var a=e.headers[Object.keys(e.headers).find(function(e){return"set-cookie"===e.toLowerCase()})];a||!e.headers.cookie||s.silent||console.warn("Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning."),e=a}}return(Array.isArray(e)||(e=[e]),s.map)?e.filter(t).reduce(function(e,r){var t=o(r,s);return e[t.name]=t,e},{}):e.filter(t).map(function(e){return o(e,s)})}e.exports=s,e.exports.parse=s,e.exports.parseString=o,e.exports.splitCookiesString=function(e){if(Array.isArray(e))return e;if("string"!=typeof e)return[];var r,t,o,s,a,i=[],n=0;function c(){for(;n<e.length&&/\s/.test(e.charAt(n));)n+=1;return n<e.length}for(;n<e.length;){for(r=n,a=!1;c();)if(","===(t=e.charAt(n))){for(o=n,n+=1,c(),s=n;n<e.length&&"="!==(t=e.charAt(n))&&";"!==t&&","!==t;)n+=1;n<e.length&&"="===e.charAt(n)?(a=!0,n=s,i.push(e.substring(r,o)),r=n):n=o+1}else n+=1;(!a||n>=e.length)&&i.push(e.substring(r,e.length))}return i}},3838:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>n});var o=t(5155),s=t(2115),a=t(8977),i=t(3391);let n=()=>{let[e,r]=(0,s.useState)([]),[t,n]=(0,s.useState)(!0),[c,d]=(0,s.useState)({street:"",city:"",state:"",country:"",zip:"",isPrimary:!1}),[l,u]=(0,s.useState)({}),[p,g]=(0,s.useState)(!1),[h,m]=(0,s.useState)(null),f=(0,i.d4)(e=>{var r,t;return null==e?void 0:null===(t=e.session)||void 0===t?void 0:null===(r=t.user)||void 0===r?void 0:r.id}),y=(0,i.d4)(e=>{var r;return null==e?void 0:null===(r=e.session)||void 0===r?void 0:r.token}),v=async()=>{n(!0);let e=await (0,a.Ad)(y,f);"success"===e.status?r(e.data):console.error((null==e?void 0:e.message)||"Error retrieving addresses"),n(!1)},x=()=>{let e={};return c.street.trim()||(e.street="Street is required."),c.city.trim()||(e.city="City is required."),c.state.trim()||(e.state="State is required."),c.country.trim()||(e.country="Country is required."),c.zip.trim()&&/^[0-9]{5,6}$/.test(c.zip)||(e.zip="ZIP Code must be 5-6 digits."),u(e),0===Object.keys(e).length},w=async()=>{if(x())try{let e=await (0,a.E1)(y,f,c);(null==e?void 0:e.status)==="success"?(v(),g(!1),C()):console.error((null==e?void 0:e.error)||"Error adding address")}catch(e){console.error(e)}},b=async e=>{try{let r=await (0,a.bJ)(y,f,e);(null==r?void 0:r.status)==="success"?v():console.error((null==r?void 0:r.error)||"Error setting address as primary")}catch(e){console.error(e)}},S=async e=>{try{let r=await (0,a.PC)(y,f,e);(null==r?void 0:r.status)==="success"?v():console.error((null==r?void 0:r.error)||"Error deleting address")}catch(e){console.error(e)}},k=async()=>{if(x())try{let e=await (0,a.yU)(y,f,h,c);(null==e?void 0:e.status)==="success"?(v(),g(!1),m(null),C()):console.error((null==e?void 0:e.error)||"Error updating address")}catch(e){console.error(e)}},C=()=>{d({street:"",city:"",state:"",country:"",zip:"",isPrimary:!1}),u({})};return(0,s.useEffect)(()=>{v()},[]),(0,o.jsxs)("div",{className:"container mx-auto p-6",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold mb-6 text-indigo-600",children:"Manage Addresses"}),t?(0,o.jsx)("p",{children:"Loading addresses..."}):(0,o.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[null==e?void 0:e.map(e=>(0,o.jsxs)("div",{className:"p-4 border rounded-md shadow ".concat(e.isPrimary?"border-indigo-500 bg-indigo-50":"bg-white"),children:[(0,o.jsx)("h2",{className:"text-lg font-semibold text-gray-700 mb-2",children:e.street}),(0,o.jsxs)("p",{className:"text-gray-500",children:[e.city,", ",e.state]}),(0,o.jsxs)("p",{className:"text-gray-500",children:[e.country," - ",e.zip]}),(0,o.jsx)("p",{className:"mt-2 text-sm font-medium ".concat(e.isPrimary?"text-green-600":"text-gray-400"),children:e.isPrimary?"Primary Address":""}),(0,o.jsxs)("div",{className:"flex items-center mt-4 space-x-4",children:[!e.isPrimary&&(0,o.jsx)("button",{onClick:()=>b(e.id),className:"px-3 py-1 bg-indigo-500 text-white text-sm rounded hover:bg-indigo-600",children:"Set as Default"}),(0,o.jsx)("button",{onClick:()=>{d({...e}),m(e.id),g(!0)},className:"px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",children:"Edit"}),(0,o.jsx)("button",{onClick:()=>S(e.id),className:"px-3 py-1 bg-red-500 text-white text-sm rounded hover:bg-red-600",children:"Delete"})]})]},e.id)),(0,o.jsx)("button",{onClick:()=>{C(),g(!0)},className:"p-4 border-dashed border-2 border-indigo-500 text-indigo-500 rounded-md flex justify-center items-center hover:bg-indigo-50",children:"+ Add New Address"})]}),p&&(0,o.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex justify-center items-center",children:(0,o.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[(0,o.jsx)("h2",{className:"text-2xl font-bold mb-4 text-indigo-600",children:h?"Edit Address":"Add New Address"}),(0,o.jsxs)("form",{className:"space-y-4",children:[(0,o.jsx)("input",{type:"text",placeholder:"Street",value:c.street,onChange:e=>d({...c,street:e.target.value}),className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 ".concat(l.street?"border-red-500":"focus:ring-indigo-400")}),l.street&&(0,o.jsx)("p",{className:"text-red-500 text-sm",children:l.street}),(0,o.jsx)("input",{type:"text",placeholder:"City",value:c.city,onChange:e=>d({...c,city:e.target.value}),className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 ".concat(l.city?"border-red-500":"focus:ring-indigo-400")}),l.city&&(0,o.jsx)("p",{className:"text-red-500 text-sm",children:l.city}),(0,o.jsx)("input",{type:"text",placeholder:"State",value:c.state,onChange:e=>d({...c,state:e.target.value}),className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 ".concat(l.state?"border-red-500":"focus:ring-indigo-400")}),l.state&&(0,o.jsx)("p",{className:"text-red-500 text-sm",children:l.state}),(0,o.jsx)("input",{type:"text",placeholder:"Country",value:c.country,onChange:e=>d({...c,country:e.target.value}),className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 ".concat(l.country?"border-red-500":"focus:ring-indigo-400")}),l.country&&(0,o.jsx)("p",{className:"text-red-500 text-sm",children:l.country}),(0,o.jsx)("input",{type:"text",placeholder:"ZIP Code",value:c.zip,onChange:e=>d({...c,zip:e.target.value}),className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 ".concat(l.zip?"border-red-500":"focus:ring-indigo-400")}),l.zip&&(0,o.jsx)("p",{className:"text-red-500 text-sm",children:l.zip}),(0,o.jsxs)("label",{className:"inline-flex items-center",children:[(0,o.jsx)("input",{type:"checkbox",checked:c.isPrimary,onChange:e=>d({...c,isPrimary:e.target.checked}),className:"form-checkbox h-5 w-5 text-indigo-600"}),(0,o.jsx)("span",{className:"ml-2 text-gray-600",children:"Set as Primary"})]}),(0,o.jsxs)("div",{className:"flex justify-end mt-4 space-x-2",children:[(0,o.jsx)("button",{type:"button",onClick:()=>{h?k():w()},className:"px-4 py-2 bg-indigo-500 text-white rounded hover:bg-indigo-600",children:h?"Update Address":"Save"}),(0,o.jsx)("button",{type:"button",onClick:()=>{g(!1),C()},className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Cancel"})]})]})]})})]})}},8977:(e,r,t)=>{"use strict";t.d(r,{Ad:()=>p,BD:()=>c,E1:()=>h,Hh:()=>n,PC:()=>f,RW:()=>u,bJ:()=>g,d6:()=>i,iD:()=>a,qk:()=>l,xw:()=>d,yU:()=>m});var o=t(6301),s=t(5132);async function a(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{email:t,password:a}=e;try{let e=await o.S.post("user/login",{email:t,password:a});console.log(e.data);let{token:i,data:n}=e.data;return console.log(i,n),(0,s.setCookie)(r,"shopflow_session",JSON.stringify({user:n,token:i}),{maxAge:2592e3,path:"/",secure:!0,sameSite:"lax"}),{data:n,token:i}}catch(e){throw console.log(e),Error(e.response||"An error occurred during login.")}}async function i(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{let t=await o.S.post("user/oauth",{name:null==e?void 0:e.name,email:null==e?void 0:e.email,image:null==e?void 0:e.image,id:null==e?void 0:e.id}),{token:a,data:i}=t.data;return(0,s.setCookie)(r,"shopflow_session",JSON.stringify({user:i,token:a}),{maxAge:2592e3,path:"/",secure:!0,sameSite:"lax"}),t.data}catch(e){throw Error(e||"An error occurred during Google OAuth.")}}async function n(e){let{username:r,email:t,password:s}=e;try{return(await o.S.post("user/signup",{name:r,email:t,password:s},{headers:{"Content-Type":"application/json"}})).data}catch(e){throw Error(e.response.data.message||"An error occurred during sign-up.")}}async function c(e){try{var r;let t=await o.S.post("user/forgotPassword?email=".concat(e));if(console.log(t),200===t.status)return{ok:!0,data:t.data};return{ok:!1,message:(null===(r=t.data)||void 0===r?void 0:r.message)||"Something went wrong."}}catch(e){throw console.log(e),e}}async function d(e,r){try{return await o.S.post("user/resetPassword?token=".concat(e,"&newPassword=").concat(r))}catch(e){console.log(e)}}async function l(e,r){try{console.log("test");let t=await o.S.post("user/userProfileInfo?userId=".concat(r),{},{headers:{Authorization:"Bearer ".concat(e)}});return console.log(t),t}catch(e){console.log(e)}}async function u(e,r,t){try{console.log("test");let s=await o.S.post("user/updateUserProfile?userId=".concat(r),t,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"}});return console.log(s),s}catch(e){throw console.log(e),e}}async function p(e,r){try{console.log("token",e);let t=await o.S.post("user/getAllAddress?userId=".concat(r),{},{headers:{Authorization:"Bearer ".concat(e)}});return console.log(t),t.data}catch(e){return console.error("Error fetching addresses:",e),{error:e.message||"Something went wrong!"}}}let g=async(e,r,t)=>{try{let s=await o.S.post("user/makePrimaryAddress",{},{params:{userId:r,addressId:t},headers:{Authorization:"Bearer ".concat(e)}});return console.log(s),s.data}catch(e){return console.error("Error fetching addresses:",e),{error:e.message||"Something went wrong!"}}},h=async(e,r,t)=>{try{let{street:s,city:a,state:i,country:n,zip:c,isPrimary:d}=t;return(await o.S.post("user/addAddress",{},{params:{userId:r,street:s,city:a,state:i,country:n,zip:c,isPrimary:d},headers:{Authorization:"Bearer ".concat(e)}})).data}catch(e){var s,a;return console.error("Error adding address:",e),{error:(null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||"Something went wrong!"}}},m=async(e,r,t,s)=>{try{let{street:a,city:i,state:n,country:c,zip:d,isPrimary:l}=s;return(await o.S.post("user/editAddress",{},{params:{userId:r,addressId:t,street:a,city:i,state:n,country:c,zip:d,isPrimary:l},headers:{Authorization:"Bearer ".concat(e)}})).data}catch(e){var a,i;return console.error("Error adding address:",e),{error:(null===(i=e.response)||void 0===i?void 0:null===(a=i.data)||void 0===a?void 0:a.message)||"Something went wrong!"}}},f=async(e,r,t)=>{try{return(await o.S.post("user/deleteAddress",{},{params:{userId:r,addressId:t},headers:{Authorization:"Bearer ".concat(e)}})).data}catch(e){var s,a;return console.error("Error adding address:",e),{error:(null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||"Something went wrong!"}}}},6301:(e,r,t)=>{"use strict";t.d(r,{S:()=>o});let o=t(2651).A.create({baseURL:"http://192.168.0.114:5000"})}},e=>{var r=r=>e(e.s=r);e.O(0,[651,391,441,517,358],()=>r(5471)),_N_E=e.O()}]);