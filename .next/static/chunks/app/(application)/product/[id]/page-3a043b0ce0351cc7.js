(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[86],{8520:(e,r,t)=>{Promise.resolve().then(t.bind(t,5710))},5710:(e,r,t)=>{"use strict";t.d(r,{default:()=>w});var a=t(5155),o=t(2324),s=t(2115),n=t(3391),c=t(5565),l=t(6039),i=t(7788),d=t(3100),u=t(227),g=t(6046),h=t(2895);let p=e=>{let{subCategoryId:r}=e,[t,o]=(0,s.useState)([]),[c,l]=(0,s.useState)(!0),[i,d]=(0,s.useState)(""),h=(0,g.useRouter)();(0,n.wA)(),(0,s.useEffect)(()=>{(async()=>{try{let e=await (0,u.Zu)(r);o(e.data)}catch(e){d(e.message)}finally{l(!1)}})()},[r]);let p=e=>{h.push("/product/".concat(e.id))};return c?(0,a.jsx)("div",{className:"text-center",children:"Loading..."}):i?(0,a.jsx)("div",{className:"text-red-600 text-center",children:i}):(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Similar Products"}),(0,a.jsx)("div",{className:"flex overflow-x-auto space-x-6 p-4",children:t.map(e=>(0,a.jsxs)("div",{className:"min-w-[220px] bg-white shadow-lg rounded-lg p-4 transition-transform transform hover:scale-105",children:[(0,a.jsx)("img",{src:e.image,alt:e.name,className:"h-40 w-full object-cover rounded-md mb-2"}),(0,a.jsx)("h3",{className:"text-lg font-semibold",children:e.name}),(0,a.jsxs)("p",{className:"text-gray-700",children:["$",e.offerPrice.toFixed(2)]}),(0,a.jsx)("button",{onClick:()=>p(e),className:"mt-3 w-full bg-gray-300 text-gray-800 py-2 rounded-md hover:bg-gray-400 transition duration-300",children:"View Product"})]},e.id))})]})};var m=t(6783),f=t(9765),y=t(2738),v=t(9398),x=t(3956);function w(e){let{productId:r=1}=e,t=(0,n.wA)(),u=(0,g.useRouter)(),{toast:w}=(0,v.dj)(),{data:S=[],loading:E,error:j}=(0,n.d4)(e=>e.product),N=null==S?void 0:S.data,b=(0,n.d4)(e=>{var r;return null===(r=e.userData)||void 0===r?void 0:r.user}),I=(0,n.d4)(e=>{var r;return null===(r=e.userData)||void 0===r?void 0:r.token}),A=new m.A,[C,T]=(0,s.useState)(""),[O,P]=(0,s.useState)(""),[k,_]=(0,s.useState)({buy:!1,cart:!1,wishlist:!1});(0,s.useEffect)(()=>{t((0,o.Fd)("/products/getProductById?productId=".concat(r)))},[t,r]);let D=(e,r)=>{w("success"===r?{title:"Success",description:e}:{title:"Error",description:e,variant:"destructive"})},F=e=>{var r;t((0,h.Sd)({orders:{orders:e}})),u.push("/checkout/".concat(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.id))},U=async()=>{_(e=>({...e,buy:!0}));try{let e=b?b.id:"",r=[{productId:N.id,quantity:1}],t=await (0,y.fS)(e,r);D("Order created successfully! Redirecting to checkout...","success"),F(t)}catch(e){console.error("Order creation failed:",e),D("Failed to create order. Please try again.","error")}finally{_(e=>({...e,buy:!1}))}},q=async()=>{_(e=>({...e,cart:!0}));try{if(b){let e=await A.addItemToCart(b.id,N.id);D(e.message||"Product added to your cart!","success")}else(0,x.Bj)(N),D("Product added to your guest cart!","success")}catch(e){D("An unexpected error occurred. Please try again.","error"),console.error("Error adding to cart:",e)}finally{_(e=>({...e,cart:!1}))}},B=async()=>{_(e=>({...e,wishlist:!0})),console.log(N);try{var e;let r=await (0,f.lx)(N.id,I);D((null==r?void 0:null===(e=r.data)||void 0===e?void 0:e.message)||"Product added to Wishlist","success")}catch(e){D("An unexpected error occurred. Please try again.","error"),console.error("Error updating wishlist:",e)}finally{_(e=>({...e,wishlist:!1}))}};return E?(0,a.jsx)("p",{className:"text-center text-lg font-medium",children:"Loading..."}):j?(0,a.jsxs)("p",{className:"text-center text-red-500",children:["Error: ",j]}):N?(0,a.jsxs)("div",{className:"container mx-auto p-4",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row bg-white shadow-lg rounded-xl overflow-hidden lg:max-h-96",children:[(0,a.jsx)("div",{className:"lg:w-2/5 p-4 flex justify-center items-center bg-gray-100",children:(0,a.jsx)(c.default,{src:N.image,alt:N.name,width:400,height:300,className:"object-contain w-full h-auto max-w-xs rounded-lg"})}),(0,a.jsxs)("div",{className:"lg:w-3/5 p-6 flex flex-col gap-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:N.name}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"bg-orange-500 text-white px-2 py-1 rounded text-sm font-semibold flex items-center",children:[N.rating," ",(0,a.jsx)(l.A,{className:"ml-1 w-4 h-4"})]}),(0,a.jsxs)("span",{className:"text-gray-500",children:["(",N.reviews," Reviews)"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("span",{className:"text-3xl font-bold text-gray-800",children:["₹",N.offerPrice]}),(0,a.jsxs)("span",{className:"text-gray-500 line-through",children:["₹",N.actualPrice]}),(0,a.jsxs)("span",{className:"text-orange-500 font-semibold",children:[N.discountPercentage,"% off"]})]}),(0,a.jsx)("p",{className:"text-gray-600 text-sm",children:N.description}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-self-end",children:[(0,a.jsx)("button",{onClick:b?U:()=>D("Please log in to buy.","error"),className:"bg-gray-800 text-white px-6 py-2 rounded flex items-center justify-center gap-2 text-lg font-medium w-full sm:w-auto",disabled:k.buy,children:k.buy?(0,a.jsx)("span",{className:"animate-pulse",children:"Loading..."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.A,{className:"w-5 h-5"})," Buy Now"]})}),(0,a.jsx)("button",{onClick:q,className:"bg-gray-800 text-white px-6 py-2 rounded flex items-center justify-center gap-2 text-lg font-medium w-full sm:w-auto",disabled:k.cart,children:k.cart?(0,a.jsx)("span",{className:"animate-pulse",children:"Loading..."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.A,{className:"w-5 h-5"})," Add to Cart"]})}),(0,a.jsx)("button",{onClick:B,className:"bg-gray-800 text-white px-6 py-2 rounded flex items-center justify-center gap-2 text-lg font-medium w-full sm:w-auto",disabled:k.wishlist,children:k.wishlist?(0,a.jsx)("span",{className:"animate-pulse",children:"Loading..."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.A,{className:"w-5 h-5"})," Wishlist"]})})]}),C&&(0,a.jsx)("div",{className:"mt-4 p-2 text-sm ".concat("success"===O?"text-green-600":"text-red-600"),children:C})]})]}),(0,a.jsx)(p,{subCategoryId:N.subCategoryId||1})]}):(0,a.jsx)("p",{className:"text-center text-gray-600",children:"No product found"})}},2324:(e,r,t)=>{"use strict";t.d(r,{Ay:()=>d,Fd:()=>i});var a=t(8943),o=t(6301);let s=(0,a.Z0)({name:"product",initialState:{data:null,loading:!1,error:null},reducers:{fetchDataStart(e){e.loading=!0,e.error=null},fetchDataSuccess(e,r){e.loading=!1,e.data=r.payload},fetchDataFailure(e,r){e.loading=!1,e.error=r.payload}}}),{fetchDataStart:n,fetchDataSuccess:c,fetchDataFailure:l}=s.actions,i=e=>async r=>{r(n());try{let t=await o.S.get(e);r(c(t.data))}catch(e){var t;r(l((null===(t=e.response)||void 0===t?void 0:t.data)||e.message))}},d=s.reducer},2895:(e,r,t)=>{"use strict";t.d(r,{Ay:()=>n,Dh:()=>s,Sd:()=>o});let a=(0,t(8943).Z0)({name:"props",initialState:{product:null,history:null},reducers:{setProductData(e,r){console.log(r),e.product=r.payload,console.log(r.payload)},setHistory(e,r){e.history=r.payload,console.log(e.history)}}}),{setProductData:o,setHistory:s}=a.actions,n=a.reducer},3956:(e,r,t)=>{"use strict";t.d(r,{Bj:()=>l,CG:()=>u,Xl:()=>g,dv:()=>n,o7:()=>d,qY:()=>i});let a="shopflow";function o(){let e=localStorage.getItem(a);return e?JSON.parse(e):[]}function s(e){localStorage.setItem(a,JSON.stringify(e))}function n(){return o().reduce((e,r)=>e+r.offerPrice*r.quantity,0)}function c(e,r){return e.findIndex(e=>e.id===r)}function l(e){let r=o(),t=c(r,e.id);-1===t?r.push({...e,quantity:1}):r[t].quantity+=1,s(r)}function i(e){let r=o();s(r=r.filter(r=>r.id!==e))}function d(e){let r=o(),t=c(r,e);-1!==t&&(r[t].quantity+=1,s(r)),console.log(o())}function u(e){let r=o(),t=c(r,e);-1!==t&&(r[t].quantity>1?r[t].quantity-=1:i(e),s(r))}function g(){return o()}},2738:(e,r,t)=>{"use strict";t.d(r,{N4:()=>i,TU:()=>c,fS:()=>o,gY:()=>l,kp:()=>s,p:()=>d,yT:()=>n});var a=t(6301);let o=async e=>{try{let r=await a.S.post("/user/order/createOrder",{items:e});return console.log(r),r.data}catch(e){var r,t;throw console.error("Error creating order:",e),Error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||"Error creating order.")}},s=async e=>{try{return(await a.S.get("/user/order/getOrderForCheckout/?orderId=".concat(e))).data}catch(e){var r,t;return console.error("Error fetching order for checkout:",e),{status:"error",message:(null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||"An error occurred while fetching the order."}}},n=async(e,r,t,o)=>{console.log("order_id:",e),console.log("razorpayId:",r),console.log("paymentId:",t),console.log("siign:",o);try{return(await a.S.post("/user/order/verify",{},{params:{orderId:e,razorpayId:r,paymentId:t,paymentSignature:o}})).data}catch(e){var s,n;throw console.error("Error verifying payment:",e),Error((null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.message)||"Error verifying payment.")}},c=async e=>{console.log("orderid:",e);try{return(await a.S.post("/user/order/checkoutOrder?orderId=".concat(e))).data}catch(e){var r,t;throw console.error("Error fetching user orders:",e),Error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||"Error fetching user orders.")}},l=async()=>{try{return(await a.S.get("/user/order/getUserOrder")).data}catch(t){var e,r;throw console.error("Error fetching user orders:",t),Error((null==t?void 0:null===(r=t.response)||void 0===r?void 0:null===(e=r.data)||void 0===e?void 0:e.message)||"Error fetching user orders.")}},i=async e=>{console.log(e);try{return(await a.S.put("/user/order/cancelOrder?orderId=".concat(e))).data}catch(e){var r,t;throw console.error("Error cancelling order:",e),Error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||"Error cancelling order.")}},d=async e=>{console.log("userId:",e);try{let r=await a.S.get("/user/order/getOrderById?orderId=".concat(e));return console.log(r.data),r.data}catch(e){var r,t;throw console.error("Error fetching user orders:",e),Error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||"Error fetching user orders.")}}},227:(e,r,t)=>{"use strict";t.d(r,{K4:()=>o,Lp:()=>c,ZU:()=>i,Zu:()=>s,d$:()=>n,p7:()=>l}),t(2115);var a=t(6301);let o=async e=>{console.log(e);try{return(await a.S.get("/products/filteredProducts",{params:{categoryName:null==e?void 0:e.selectedCategory,subCategoryNames:null==e?void 0:e.selectedSubcategories,sort:null==e?void 0:e.sortOption}})).data}catch(e){throw console.error("Error fetching filtered products:",e.message),Error("Unable to fetch filtered products. Please try again later.")}};async function s(e){try{let r=await a.S.get("/products/getProductsByCategory",{params:{subCategoryId:e}});return console.log(r.data),r.data}catch(e){throw console.error("Error fetching products by subcategory:",e.message),Error("Unable to fetch products for the selected subcategory. Please try again later.")}}async function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{return(await a.S.get("/products/getAllProducts",{params:{page:e}})).data}catch(e){throw console.error("Error fetching products:",e.message),Error("Unable to fetch products. Please try again later.")}}async function c(){try{return(await a.S.get("/products/getNewArrivals")).data}catch(e){throw console.error("Error fetching flash deals:",e.message),Error("Unable to fetch flash deals. Please try again later.")}}async function l(){try{let e=await a.S.get("/products/Category");return console.log(e.data),e.data}catch(e){throw console.error("Error fetching categories:",e.message),Error("Unable to fetch categories. Please try again later.")}}async function i(e){try{return(await a.S.get("/products/getProductBySearch",{params:{query:e}})).data}catch(e){throw console.error("Error fetching searched products:",e.message),Error("Unable to search for products. Please try again later.")}}},6783:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});var a=t(3391),o=t(6301);let s=function(){let e=(0,a.d4)(e=>e.userData.token),r="shopflow",t=()=>({Authorization:"Bearer ".concat(e),"Content-Type":"application/json"});this.loadCart=function(){let e=localStorage.getItem(r);return e?JSON.parse(e):[]},this.saveCart=function(e){localStorage.setItem(r,JSON.stringify(e))},this.migrateCart=async function(e){let r=this.loadCart();if(console.log(r,e),r.length>0){for(let t of r)try{console.log(t);let r=await this.addItemToCart(e,t.id,t.quantity);console.log("migrated",r)}catch(e){console.error("Error migrating cart item:",e)}this.clearCart()}},this.addItemToCart=async function(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;console.log(e),console.log(r);try{return(await o.S.post("/user/cart/addItemToCart",{},{params:{userId:e,productId:r,quantity:a},headers:t()})).data}catch(e){throw console.log(e),console.error("Error adding item to cart:",e),e.response?e.response.data:Error("Network or server error")}},this.viewCart=async function(e){try{let r=await o.S.get("/user/cart/viewCart",{params:{userId:e},headers:t()});if(200===r.status)return r.data.data||[];throw Error(r.data.message||"Failed to retrieve cart")}catch(e){throw console.error("Error viewing cart:",e),e.response?e.response.data:Error("Network or server error")}},this.deleteFromCart=async function(e){try{let r=await o.S.delete("/user/cart/deleteFromCart",{params:{productId:e},headers:t()});if(200===r.status)return r.data;throw Error(r.data.message||"Failed to delete item from cart")}catch(e){throw console.error("Error deleting item from cart:",e),e.response?e.response.data:Error("Network or server error")}},this.updateCartCount=async function(e,r){try{let a=await o.S.put("/user/cart/cartCount",{},{params:{productId:e,operation:r},headers:t()});if(console.log(a.status),200===a.status)return a.data;throw Error(a.data||"Failed to update cart count")}catch(e){throw console.error("Error updating cart count:",e),e}},this.clearCart=function(){localStorage.removeItem(r)}}},9765:(e,r,t)=>{"use strict";t.d(r,{UI:()=>o,lx:()=>s});var a=t(6301);async function o(e,r){console.log("wishlist");try{let e=await a.S.get("/user/wishlist/viewWishlist",{headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});return console.log("wishlist",e),e.data.data.products||[]}catch(e){return console.error("Error loading wishlist:",e),[]}}async function s(e,r){try{return await a.S.post("/user/wishlist/addOrRemoveItem",{},{params:{productId:e},headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}})}catch(e){throw console.error("Error adding or removing product to wishlist:",e),e}}},6301:(e,r,t)=>{"use strict";t.d(r,{S:()=>s});var a=t(2651),o=t(9208);let s=a.A.create({baseURL:"https://shopflow-1-ugli.onrender.com"});s.interceptors.request.use(e=>{var r;let t=o.A.get("shopflow_session");if(!t)return e;let a=null===(r=JSON.parse(t))||void 0===r?void 0:r.token;return a&&(e.headers.Authorization="Bearer ".concat(a)),e},e=>Promise.reject(e))},9398:(e,r,t)=>{"use strict";t.d(r,{dj:()=>g,oR:()=>u});var a=t(2115);let o=0,s=new Map,n=e=>{if(s.has(e))return;let r=setTimeout(()=>{s.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,r)},c=(e,r)=>{switch(r.type){case"ADD_TOAST":return{...e,toasts:[r.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===r.toast.id?{...e,...r.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=r;return t?n(t):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===r.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==r.toastId)}}},l=[],i={toasts:[]};function d(e){i=c(i,e),l.forEach(e=>{e(i)})}function u(e){let{...r}=e,t=(o=(o+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>d({type:"DISMISS_TOAST",toastId:t});return d({type:"ADD_TOAST",toast:{...r,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function g(){let[e,r]=a.useState(i);return a.useEffect(()=>(l.push(r),()=>{let e=l.indexOf(r);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}}},e=>{var r=r=>e(e.s=r);e.O(0,[794,943,391,24,441,517,358],()=>r(8520)),_N_E=e.O()}]);