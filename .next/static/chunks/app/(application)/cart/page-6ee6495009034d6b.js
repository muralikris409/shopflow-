(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[295,531],{2488:(e,r,t)=>{Promise.resolve().then(t.bind(t,2531))},6046:(e,r,t)=>{"use strict";var a=t(6658);t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},2531:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>S});var a=t(5155),o=t(2115),s=t(3956),n=t(6783),i=t(3391),l=t(6046),d=t(2738),c=t(2895),u=t(8993);t(9208);var f=t(7370),h=t(728),v=t(6894),p=t(3360),m="horizontal",g=["horizontal","vertical"],y=o.forwardRef((e,r)=>{let{decorative:t,orientation:o=m,...s}=e,n=g.includes(o)?o:m;return(0,a.jsx)(p.sG.div,{"data-orientation":n,...t?{role:"none"}:{"aria-orientation":"vertical"===n?n:void 0,role:"separator"},...s,ref:r})});y.displayName="Separator";var x=t(7849);let w=o.forwardRef((e,r)=>{let{className:t,orientation:o="horizontal",decorative:s=!0,...n}=e;return(0,a.jsx)(y,{ref:r,decorative:s,orientation:o,className:(0,x.cn)("shrink-0 bg-border","horizontal"===o?"h-[1px] w-full":"h-full w-[1px]",t),...n})});w.displayName=y.displayName;let b=(0,t(4057).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var N=t(9398);let S=()=>{let e=(0,i.wA)(),r=new n.A,t=(0,i.d4)(e=>{var r;return null===(r=e.userData)||void 0===r?void 0:r.user}),v=(0,l.useRouter)(),p=(0,i.d4)(e=>e.cart.items),m=(0,i.d4)(e=>e.cart.totalAmount)||0,[g,y]=(0,o.useState)(t?p:[]),[x,b]=(0,o.useState)(m||0),S=(0,i.d4)(e=>e.cart.error),[E,C]=(0,o.useState)(!1),{toast:k}=(0,N.dj)();console.log(m),(0,o.useEffect)(()=>{y(p),b(m)},[p]),(0,o.useEffect)(()=>{(async()=>{t?e((0,u.Fd)("/user/cart/viewCart")):(y((0,s.Xl)()),b((0,s.dv)()))})()},[t,e]);let I=e=>{v.push("/product/".concat(e))},A=async()=>{C(!0);try{let e=null==g?void 0:g.map(e=>({productId:e.productId||e.id,quantity:e.quantity})),{data:r}=await (0,d.fS)(e);v.push("/checkout/".concat(null==r?void 0:r.id))}catch(e){k({title:"Error",description:"Failed to create order. Please try again.",variant:"destructive"})}finally{C(!1)}},T=async(a,o)=>{try{t?(await r.updateCartCount(a,o),e((0,u.Fd)("/user/cart/viewCart"))):("increase"===o?(0,s.o7)(a):(0,s.CG)(a),y((0,s.Xl)()),b((0,s.dv)()))}catch(e){k({title:"Error",description:"Failed to update item quantity.",variant:"destructive"})}},O=async a=>{try{t?(await r.deleteFromCart(a),e((0,u.Fd)("/user/cart/viewCart"))):((0,s.qY)(a),y((0,s.Xl)()),b((0,s.dv)()))}catch(e){k({title:"Error",description:"Failed to remove product from cart.",variant:"destructive"})}};return(0,a.jsx)("div",{className:"w-full h-screen mx-auto p-2 md:p-4 bg-white rounded-lg shadow-md",children:(0,a.jsxs)("div",{className:"container mx-auto px-1",children:[(0,a.jsx)("h2",{className:"text-3xl font-semibold text-gray-800 mb-6",children:"Shopping Cart"}),S?(0,a.jsx)("p",{className:"text-center text-red-500",children:S.message}):(null==g?void 0:g.length)===0?(0,a.jsx)("p",{className:"text-center text-gray-600",children:"Your cart is empty"}):(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(h.Zp,{children:(0,a.jsx)(h.Wu,{className:"p-4",children:(0,a.jsx)("ul",{className:"space-y-4",children:null==g?void 0:g.map((e,r)=>(0,a.jsx)(j,{handleNavigation:I,product:t?e.product:e,onIncreaseQuantity:()=>T(e.productId||e.id,"increase"),onDecreaseQuantity:()=>T(e.productId||e.id,"decrease"),onRemoveProduct:()=>O(e.productId||e.id),quantity:null==e?void 0:e.quantity},r))})})})}),(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)(h.Zp,{className:"sticky top-16",children:[(0,a.jsx)(h.aR,{children:(0,a.jsx)(h.ZB,{className:"text-lg",children:"Price Details"})}),(0,a.jsxs)(h.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("p",{children:"Price"}),(0,a.jsxs)("p",{children:["$",x.toFixed(2)]})]}),(0,a.jsx)(w,{}),(0,a.jsxs)("div",{className:"flex justify-between font-semibold",children:[(0,a.jsx)("p",{children:"Total Amount"}),(0,a.jsxs)("p",{children:["$",x.toFixed(2)]})]}),(0,a.jsx)(f.$,{onClick:t?A:()=>{e((0,c.Dh)({route:"/cart"})),v.push("/auth")},className:"w-full",disabled:(null==g?void 0:g.length)===0||E,children:E?"Processing...":"Checkout"})]})]})})]})]})})};function j(e){var r,t;let{handleNavigation:s,product:n,onIncreaseQuantity:i,onDecreaseQuantity:l,onRemoveProduct:d,quantity:c}=e,[u,h]=(0,o.useState)(!1),{toast:p}=(0,N.dj)(),m=async(e,r)=>{h(!0);try{await e(r)}catch(e){p({title:"Error",description:"Operation failed. Please try again.",variant:"destructive"})}finally{h(!1)}};return(0,a.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden ".concat(u?"animate-pulse":""),children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row p-4 gap-4",children:[(0,a.jsx)("img",{className:"w-full md:w-24 h-24 rounded-lg object-cover",src:null==n?void 0:n.image,alt:null==n?void 0:n.name}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{onClick:()=>s(null==n?void 0:n.id),className:"text-lg font-semibold text-gray-900 hover:underline cursor-pointer",children:null==n?void 0:n.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["$",null==n?void 0:null===(r=n.offerPrice)||void 0===r?void 0:r.toFixed(2)," ",(0,a.jsxs)("span",{className:"line-through text-gray-400",children:["$",null==n?void 0:null===(t=n.actualPrice)||void 0===t?void 0:t.toFixed(2)]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-3",children:[(0,a.jsx)(f.$,{variant:"outline",size:"sm",onClick:()=>m(l,null==n?void 0:n.id),disabled:u||1==c,children:"-"}),(0,a.jsx)(v.p,{className:"w-12 text-center",type:"text",value:c,readOnly:!0}),(0,a.jsx)(f.$,{variant:"outline",size:"sm",onClick:()=>m(i,null==n?void 0:n.id),disabled:u,children:"+"})]})]}),(0,a.jsx)(f.$,{size:"sm",onClick:()=>m(d,null==n?void 0:n.id),disabled:u,className:"self-start md:self-center bg-red-500",children:(0,a.jsx)(b,{className:"w-4 h-4 text-white"})})]})})}},8993:(e,r,t)=>{"use strict";t.d(r,{Ay:()=>c,Fd:()=>d});var a=t(8943),o=t(6301);let s=(0,a.Z0)({name:"cart",initialState:{items:null,loading:!1,error:null,length:null,totalAmount:null},reducers:{fetchDataStart(e){e.loading=!0,e.error=null},fetchDataSuccess(e,r){e.loading=!1,e.items=r.payload.items,e.totalAmount=r.payload.totalAmount,e.length=r.payload.items.length},fetchDataFailure(e,r){e.loading=!1,e.error=r.payload}}}),{fetchDataStart:n,fetchDataSuccess:i,fetchDataFailure:l}=s.actions,d=e=>async r=>{r(n());try{let t=await o.S.get(e);console.log(t),r(i(t.data.data))}catch(e){var t;r(l((null===(t=e.response)||void 0===t?void 0:t.data)||e.message))}},c=s.reducer},2895:(e,r,t)=>{"use strict";t.d(r,{Ay:()=>n,Dh:()=>s,Sd:()=>o});let a=(0,t(8943).Z0)({name:"props",initialState:{product:null,history:null},reducers:{setProductData(e,r){console.log(r),e.product=r.payload,console.log(r.payload)},setHistory(e,r){e.history=r.payload,console.log(e.history)}}}),{setProductData:o,setHistory:s}=a.actions,n=a.reducer},3956:(e,r,t)=>{"use strict";t.d(r,{Bj:()=>l,CG:()=>u,Xl:()=>f,dv:()=>n,o7:()=>c,qY:()=>d});let a="shopflow";function o(){let e=localStorage.getItem(a);return e?JSON.parse(e):[]}function s(e){localStorage.setItem(a,JSON.stringify(e))}function n(){return o().reduce((e,r)=>e+r.offerPrice*r.quantity,0)}function i(e,r){return e.findIndex(e=>e.id===r)}function l(e){let r=o(),t=i(r,e.id);-1===t?r.push({...e,quantity:1}):r[t].quantity+=1,s(r)}function d(e){let r=o();s(r=r.filter(r=>r.id!==e))}function c(e){let r=o(),t=i(r,e);-1!==t&&(r[t].quantity+=1,s(r)),console.log(o())}function u(e){let r=o(),t=i(r,e);-1!==t&&(r[t].quantity>1?r[t].quantity-=1:d(e),s(r))}function f(){return o()}},2738:(e,r,t)=>{"use strict";t.d(r,{N4:()=>d,TU:()=>i,fS:()=>o,gY:()=>l,kp:()=>s,p:()=>c,yT:()=>n});var a=t(6301);let o=async e=>{try{let r=await a.S.post("/user/order/createOrder",{items:e});return console.log(r),r.data}catch(e){var r,t;throw console.error("Error creating order:",e),Error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||"Error creating order.")}},s=async e=>{try{return(await a.S.get("/user/order/getOrderForCheckout/?orderId=".concat(e))).data}catch(e){var r,t;return console.error("Error fetching order for checkout:",e),{status:"error",message:(null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||"An error occurred while fetching the order."}}},n=async(e,r,t,o)=>{console.log("order_id:",e),console.log("razorpayId:",r),console.log("paymentId:",t),console.log("siign:",o);try{return(await a.S.post("/user/order/verify",{},{params:{orderId:e,razorpayId:r,paymentId:t,paymentSignature:o}})).data}catch(e){var s,n;throw console.error("Error verifying payment:",e),Error((null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.message)||"Error verifying payment.")}},i=async e=>{console.log("orderid:",e);try{return(await a.S.post("/user/order/checkoutOrder?orderId=".concat(e))).data}catch(e){var r,t;throw console.error("Error fetching user orders:",e),Error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||"Error fetching user orders.")}},l=async()=>{try{return(await a.S.get("/user/order/getUserOrder")).data}catch(t){var e,r;throw console.error("Error fetching user orders:",t),Error((null==t?void 0:null===(r=t.response)||void 0===r?void 0:null===(e=r.data)||void 0===e?void 0:e.message)||"Error fetching user orders.")}},d=async e=>{console.log(e);try{return(await a.S.put("/user/order/cancelOrder?orderId=".concat(e))).data}catch(e){var r,t;throw console.error("Error cancelling order:",e),Error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||"Error cancelling order.")}},c=async e=>{console.log("userId:",e);try{let r=await a.S.get("/user/order/getOrderById?orderId=".concat(e));return console.log(r.data),r.data}catch(e){var r,t;throw console.error("Error fetching user orders:",e),Error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||"Error fetching user orders.")}}},6783:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});var a=t(3391),o=t(6301);let s=function(){let e=(0,a.d4)(e=>e.userData.token),r="shopflow",t=()=>({Authorization:"Bearer ".concat(e),"Content-Type":"application/json"});this.loadCart=function(){let e=localStorage.getItem(r);return e?JSON.parse(e):[]},this.saveCart=function(e){localStorage.setItem(r,JSON.stringify(e))},this.migrateCart=async function(e){let r=this.loadCart();if(console.log(r,e),r.length>0){for(let t of r)try{console.log(t);let r=await this.addItemToCart(e,t.id,t.quantity);console.log("migrated",r)}catch(e){console.error("Error migrating cart item:",e)}this.clearCart()}},this.addItemToCart=async function(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;console.log(e),console.log(r);try{return(await o.S.post("/user/cart/addItemToCart",{},{params:{userId:e,productId:r,quantity:a},headers:t()})).data}catch(e){throw console.log(e),console.error("Error adding item to cart:",e),e.response?e.response.data:Error("Network or server error")}},this.viewCart=async function(e){try{let r=await o.S.get("/user/cart/viewCart",{params:{userId:e},headers:t()});if(200===r.status)return r.data.data||[];throw Error(r.data.message||"Failed to retrieve cart")}catch(e){throw console.error("Error viewing cart:",e),e.response?e.response.data:Error("Network or server error")}},this.deleteFromCart=async function(e){try{let r=await o.S.delete("/user/cart/deleteFromCart",{params:{productId:e},headers:t()});if(200===r.status)return r.data;throw Error(r.data.message||"Failed to delete item from cart")}catch(e){throw console.error("Error deleting item from cart:",e),e.response?e.response.data:Error("Network or server error")}},this.updateCartCount=async function(e,r){try{let a=await o.S.put("/user/cart/cartCount",{},{params:{productId:e,operation:r},headers:t()});if(console.log(a.status),200===a.status)return a.data;throw Error(a.data||"Failed to update cart count")}catch(e){throw console.error("Error updating cart count:",e),e}},this.clearCart=function(){localStorage.removeItem(r)}}},6301:(e,r,t)=>{"use strict";t.d(r,{S:()=>s});var a=t(2651),o=t(9208);let s=a.A.create({baseURL:"https://shopflow-1-ugli.onrender.com"});s.interceptors.request.use(e=>{var r;let t=o.A.get("shopflow_session");if(!t)return e;let a=null===(r=JSON.parse(t))||void 0===r?void 0:r.token;return a&&(e.headers.Authorization="Bearer ".concat(a)),e},e=>Promise.reject(e))},7370:(e,r,t)=>{"use strict";t.d(r,{$:()=>d});var a=t(5155),o=t(2115),s=t(2317),n=t(1027),i=t(7849);let l=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=o.forwardRef((e,r)=>{let{className:t,variant:o,size:n,asChild:d=!1,...c}=e,u=d?s.DX:"button";return(0,a.jsx)(u,{className:(0,i.cn)(l({variant:o,size:n,className:t})),ref:r,...c})});d.displayName="Button"},728:(e,r,t)=>{"use strict";t.d(r,{Wu:()=>d,ZB:()=>l,Zp:()=>n,aR:()=>i});var a=t(5155),o=t(2115),s=t(7849);let n=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...o})});n.displayName="Card";let i=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",t),...o})});i.displayName="CardHeader";let l=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",t),...o})});l.displayName="CardTitle",o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",t),...o})}).displayName="CardDescription";let d=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",t),...o})});d.displayName="CardContent",o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",t),...o})}).displayName="CardFooter"},6894:(e,r,t)=>{"use strict";t.d(r,{p:()=>n});var a=t(5155),o=t(2115),s=t(7849);let n=o.forwardRef((e,r)=>{let{className:t,type:o,...n}=e;return(0,a.jsx)("input",{type:o,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n})});n.displayName="Input"},9398:(e,r,t)=>{"use strict";t.d(r,{dj:()=>f,oR:()=>u});var a=t(2115);let o=0,s=new Map,n=e=>{if(s.has(e))return;let r=setTimeout(()=>{s.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,r)},i=(e,r)=>{switch(r.type){case"ADD_TOAST":return{...e,toasts:[r.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===r.toast.id?{...e,...r.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=r;return t?n(t):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===r.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==r.toastId)}}},l=[],d={toasts:[]};function c(e){d=i(d,e),l.forEach(e=>{e(d)})}function u(e){let{...r}=e,t=(o=(o+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...r,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function f(){let[e,r]=a.useState(d);return a.useEffect(()=>(l.push(r),()=>{let e=l.indexOf(r);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},7849:(e,r,t)=>{"use strict";t.d(r,{cn:()=>s});var a=t(3463),o=t(9795);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,o.QP)((0,a.$)(r))}},3360:(e,r,t)=>{"use strict";t.d(r,{hO:()=>l,sG:()=>i});var a=t(2115),o=t(7650),s=t(2317),n=t(5155),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,r)=>{let t=a.forwardRef((e,t)=>{let{asChild:a,...o}=e,i=a?s.DX:r;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,n.jsx)(i,{...o,ref:t})});return t.displayName=`Primitive.${r}`,{...e,[r]:t}},{});function l(e,r){e&&o.flushSync(()=>e.dispatchEvent(r))}}},e=>{var r=r=>e(e.s=r);e.O(0,[794,943,391,129,441,517,358],()=>r(2488)),_N_E=e.O()}]);