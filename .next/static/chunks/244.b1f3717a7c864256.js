"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[244],{5132:function(e,t,r){var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.destroyCookie=t.setCookie=t.parseCookies=void 0;var a=r(5451),s=r(7079),n=r(7273);function i(e,t){var r,o;return(null===(o=null===(r=null==e?void 0:e.req)||void 0===r?void 0:r.headers)||void 0===o?void 0:o.cookie)?a.parse(e.req.headers.cookie,t):n.isBrowser()?a.parse(document.cookie,t):{}}function l(e,t,r,i){var l,d;if(void 0===i&&(i={}),(null===(l=null==e?void 0:e.res)||void 0===l?void 0:l.getHeader)&&e.res.setHeader){if(null===(d=null==e?void 0:e.res)||void 0===d?void 0:d.finished)return console.warn('Not setting "'+t+'" cookie. Response has finished.'),console.warn("You should set cookie before res.send()"),{};var u=e.res.getHeader("Set-Cookie")||[];"string"==typeof u&&(u=[u]),"number"==typeof u&&(u=[]);var c=s.parse(u,{decodeValues:!1}),p=n.createCookie(t,r,i),h=[];c.forEach(function(e){if(!n.areCookiesEqual(e,p)){var t=a.serialize(e.name,e.value,o({encode:function(e){return e}},e));h.push(t)}}),h.push(a.serialize(t,r,i)),e.res.setHeader("Set-Cookie",h)}if(n.isBrowser()){if(i&&i.httpOnly)throw Error("Can not set a httpOnly cookie in the browser.");document.cookie=a.serialize(t,r,i)}return{}}function d(e,t,r){return l(e,t,"",o(o({},r||{}),{maxAge:-1}))}t.parseCookies=i,t.setCookie=l,t.destroyCookie=d,t.default={set:l,get:i,destroy:d}},7273:function(e,t){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function o(e,t){var r=Object.getOwnPropertyNames(e),o=Object.getOwnPropertyNames(t);if(r.length!==o.length)return!1;for(var a=0;a<r.length;a++){var s=r[a];if(e[s]!==t[s])return!1}return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.areCookiesEqual=t.hasSameProperties=t.createCookie=t.isBrowser=void 0,t.isBrowser=function(){return"undefined"!=typeof window},t.createCookie=function(e,t,o){var a=o.sameSite;!0===a&&(a="strict"),(void 0===a||!1===a)&&(a="lax");var s=r(r({},o),{sameSite:a});return delete s.encode,r({name:e,value:t},s)},t.hasSameProperties=o,t.areCookiesEqual=function(e,t){var a=e.sameSite===t.sameSite;return"string"==typeof e.sameSite&&"string"==typeof t.sameSite&&(a=e.sameSite.toLowerCase()===t.sameSite.toLowerCase()),o(r(r({},e),{sameSite:void 0}),r(r({},t),{sameSite:void 0}))&&a}},5451:(e,t)=>{t.parse=function(e,t){if("string"!=typeof e)throw TypeError("argument str must be a string");for(var o={},a=e.split(";"),s=(t||{}).decode||r,n=0;n<a.length;n++){var i=a[n],l=i.indexOf("=");if(!(l<0)){var d=i.substring(0,l).trim();if(void 0==o[d]){var u=i.substring(l+1,i.length).trim();'"'===u[0]&&(u=u.slice(1,-1)),o[d]=function(e,t){try{return t(e)}catch(t){return e}}(u,s)}}}return o},t.serialize=function(e,t,r){var s=r||{},n=s.encode||o;if("function"!=typeof n)throw TypeError("option encode is invalid");if(!a.test(e))throw TypeError("argument name is invalid");var i=n(t);if(i&&!a.test(i))throw TypeError("argument val is invalid");var l=e+"="+i;if(null!=s.maxAge){var d=s.maxAge-0;if(isNaN(d)||!isFinite(d))throw TypeError("option maxAge is invalid");l+="; Max-Age="+Math.floor(d)}if(s.domain){if(!a.test(s.domain))throw TypeError("option domain is invalid");l+="; Domain="+s.domain}if(s.path){if(!a.test(s.path))throw TypeError("option path is invalid");l+="; Path="+s.path}if(s.expires){if("function"!=typeof s.expires.toUTCString)throw TypeError("option expires is invalid");l+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(l+="; HttpOnly"),s.secure&&(l+="; Secure"),s.sameSite)switch("string"==typeof s.sameSite?s.sameSite.toLowerCase():s.sameSite){case!0:case"strict":l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"none":l+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return l};var r=decodeURIComponent,o=encodeURIComponent,a=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},7079:e=>{var t={decodeValues:!0,map:!1,silent:!1};function r(e){return"string"==typeof e&&!!e.trim()}function o(e,o){var a,s,n,i,l=e.split(";").filter(r),d=(a=l.shift(),s="",n="",(i=a.split("=")).length>1?(s=i.shift(),n=i.join("=")):n=a,{name:s,value:n}),u=d.name,c=d.value;o=o?Object.assign({},t,o):t;try{c=o.decodeValues?decodeURIComponent(c):c}catch(e){console.error("set-cookie-parser encountered an error while decoding a cookie with value '"+c+"'. Set options.decodeValues to false to disable this feature.",e)}var p={name:u,value:c};return l.forEach(function(e){var t=e.split("="),r=t.shift().trimLeft().toLowerCase(),o=t.join("=");"expires"===r?p.expires=new Date(o):"max-age"===r?p.maxAge=parseInt(o,10):"secure"===r?p.secure=!0:"httponly"===r?p.httpOnly=!0:"samesite"===r?p.sameSite=o:"partitioned"===r?p.partitioned=!0:p[r]=o}),p}function a(e,a){if(a=a?Object.assign({},t,a):t,!e)return a.map?{}:[];if(e.headers){if("function"==typeof e.headers.getSetCookie)e=e.headers.getSetCookie();else if(e.headers["set-cookie"])e=e.headers["set-cookie"];else{var s=e.headers[Object.keys(e.headers).find(function(e){return"set-cookie"===e.toLowerCase()})];s||!e.headers.cookie||a.silent||console.warn("Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning."),e=s}}return(Array.isArray(e)||(e=[e]),a.map)?e.filter(r).reduce(function(e,t){var r=o(t,a);return e[r.name]=r,e},{}):e.filter(r).map(function(e){return o(e,a)})}e.exports=a,e.exports.parse=a,e.exports.parseString=o,e.exports.splitCookiesString=function(e){if(Array.isArray(e))return e;if("string"!=typeof e)return[];var t,r,o,a,s,n=[],i=0;function l(){for(;i<e.length&&/\s/.test(e.charAt(i));)i+=1;return i<e.length}for(;i<e.length;){for(t=i,s=!1;l();)if(","===(r=e.charAt(i))){for(o=i,i+=1,l(),a=i;i<e.length&&"="!==(r=e.charAt(i))&&";"!==r&&","!==r;)i+=1;i<e.length&&"="===e.charAt(i)?(s=!0,i=a,n.push(e.substring(t,o)),t=i):i=o+1}else i+=1;(!s||i>=e.length)&&n.push(e.substring(t,e.length))}return n}},4244:(e,t,r)=>{r.r(t),r.d(t,{default:()=>d});var o=r(5155),a=r(2115),s=r(8977),n=r(3391),i=r(2854),l=r(9398);let d=()=>{var e;let t=(0,n.wA)(),r=(0,n.d4)(e=>null==e?void 0:e.userData),d=null==r?void 0:r.user,u=null==r?void 0:r.token,c=null==d?void 0:d.id,[p,h]=(0,a.useState)({name:(null==d?void 0:d.name)||"",phone:(null==d?void 0:d.phone)||""}),[m,f]=(0,a.useState)((null==d?void 0:d.profile_pic)||null),[g,v]=(0,a.useState)(!1),[y,w]=(0,a.useState)({});(0,a.useEffect)(()=>{d&&(f(d.profile_pic||null),h({name:d.name||"",phone:d.phone||""}))},[r]);let S=()=>{let e={};return p.name.trim()||(e.name="Name is required."),/^\d{10}$/.test(p.phone)||(e.phone="Phone number must be 10 digits."),w(e),0===Object.keys(e).length},x=e=>{let{name:t,value:r}=e.target;h(e=>({...e,[t]:r}))},b=async e=>{if(e.preventDefault(),!S())return;v(!0);let r=new FormData;r.append("name",p.name),r.append("phone",p.phone);let o=e.target.profileImage.files[0];o&&r.append("profile",o);try{let e=await (0,s.RW)(u,c,r);200===e.status&&((0,l.oR)({title:"Success",description:"Profile updated successfully!"}),t((0,i.Fd)("/user/userProfileInfo?userId=".concat(c),u)))}catch(e){var a,n;(0,l.oR)({title:"Error",description:(null===(n=e.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.message)||"An error occurred.",variant:"destructive"})}finally{v(!1)}};return(0,o.jsxs)("div",{className:"w-full h-screen mx-auto p-2 md:p-4 bg-white rounded-lg shadow-md",children:[(0,o.jsx)("h2",{className:"text-3xl font-semibold text-gray-800 mb-6",children:"Edit Profile"}),(0,o.jsxs)("form",{onSubmit:b,encType:"multipart/form-data",children:[(0,o.jsx)("div",{className:"flex flex-col items-center mb-6 relative",children:(0,o.jsxs)("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-200 flex items-center justify-center relative group",children:[m?(0,o.jsx)("img",{src:m,alt:"Profile",className:"w-full h-full object-cover"}):(0,o.jsx)("span",{className:"text-3xl font-bold text-gray-500",children:null==d?void 0:null===(e=d.name)||void 0===e?void 0:e.charAt(0)}),(0,o.jsxs)("label",{className:"absolute inset-0 bg-white/10 backdrop-blur-md flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 cursor-pointer rounded-full",children:[(0,o.jsx)("span",{className:"text-white px-3 py-1 rounded-md text-sm shadow-md",children:"Edit âœŽ"}),(0,o.jsx)("input",{type:"file",name:"profileImage",accept:"image/*",onChange:e=>{let t=e.target.files[0];if(t&&t.type.startsWith("image/")){let e=new FileReader;e.onloadend=()=>f(e.result),e.readAsDataURL(t)}else(0,l.oR)({title:"Invalid file type",description:"Please upload an image.",variant:"destructive"})},className:"hidden"})]})]})}),(0,o.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,o.jsx)("input",{type:"text",id:"name",name:"name",onChange:x,value:p.name,className:"mt-1 p-2 w-full border border-gray-300 rounded-md",required:!0}),y.name&&(0,o.jsx)("p",{className:"text-red-500 text-sm",children:y.name})]}),(0,o.jsx)("div",{className:"mb-4 relative",children:(0,o.jsxs)("div",{className:"group",children:[(0,o.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,o.jsx)("input",{type:"email",id:"email",name:"email",value:null==d?void 0:d.email,className:"mt-1 p-2 w-full border border-gray-300 rounded-md bg-gray-100",disabled:!0,placeholder:"Email"}),(0,o.jsx)("span",{className:"absolute right-2 top-2 text-gray-500 text-xs hidden group-hover:block bg-gray-200 px-2 py-1 rounded-md",children:"Email can't be changed"})]})}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone"}),(0,o.jsx)("input",{type:"text",id:"phone",name:"phone",onChange:x,value:p.phone,className:"mt-1 p-2 w-full border border-gray-300 rounded-md",required:!0}),y.phone&&(0,o.jsx)("p",{className:"text-red-500 text-sm",children:y.phone})]})]}),(0,o.jsx)("div",{className:"text-center mt-6",children:(0,o.jsx)("button",{type:"submit",className:"bg-orange-500 text-white px-6 py-2 rounded-md hover:bg-orange-600 transition-colors",disabled:g,children:g?"Saving...":"Save Changes"})})]})]})}},2854:(e,t,r)=>{r.d(t,{Ay:()=>c,Fd:()=>u});var o=r(8943),a=r(6301);let s=(0,o.Z0)({name:"user",initialState:{user:null,token:null,loading:!1,error:null},reducers:{fetchDataStart(e){e.loading=!0,e.error=null},fetchDataSuccess(e,t){e.loading=!1,e.user=t.payload.user,e.token=t.payload.token},fetchDataFailure(e,t){e.loading=!1,e.error=t.payload},signOut(){state.user=null,state.token=null,state.loading=!1,state.error=null}}}),{fetchDataStart:n,fetchDataSuccess:i,fetchDataFailure:l,signOut:d}=s.actions,u=(e,t)=>async r=>{var o,s;r(n()),console.log(t);try{let s=await a.S.get(e,{headers:{Authorization:"Bearer ".concat(t)}});console.log(s),r(i({user:null==s?void 0:null===(o=s.data)||void 0===o?void 0:o.data,token:t}))}catch(e){r(l((null===(s=e.response)||void 0===s?void 0:s.data)||e.message))}},c=s.reducer},8977:(e,t,r)=>{r.d(t,{Ad:()=>c,BD:()=>l,E1:()=>h,Hh:()=>i,PC:()=>f,RW:()=>u,bJ:()=>p,d6:()=>n,iD:()=>s,xw:()=>d,yU:()=>m});var o=r(6301),a=r(5132);async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{email:r,password:s}=e;try{let e=await o.S.post("user/login",{email:r,password:s});console.log(e.data);let{token:n,data:i}=e.data;return console.log(n,i),(0,a.setCookie)(t,"shopflow_session",JSON.stringify({user:i,token:n}),{maxAge:2592e3,path:"/",sameSite:"lax"}),{data:i,token:n}}catch(e){throw console.log(e),Error(e.response.data.message||"An error occurred during login.")}}async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{let r=await o.S.post("user/oauth",{...e});console.log("google auth b-end res after gauth",r);let{token:s,data:n}=r.data;return(0,a.setCookie)(t,"shopflow_session",JSON.stringify({user:n,token:s}),{maxAge:2592e3,path:"/",sameSite:"lax"}),r.data}catch(e){var r,s;throw Error((null==e?void 0:null===(s=e.data)||void 0===s?void 0:null===(r=s.response)||void 0===r?void 0:r.message)||"An error occurred during Google OAuth.")}}async function i(e){let{username:t,email:r,password:a}=e;try{return(await o.S.post("user/signup",{name:t,email:r,password:a},{headers:{"Content-Type":"application/json"}})).data}catch(e){throw Error(e.response.data.message||"An error occurred during sign-up.")}}async function l(e){try{var t;let r=await o.S.post("user/forgotPassword?email=".concat(e));if(console.log(r),200===r.status)return{ok:!0,data:r.data};return{ok:!1,message:(null===(t=r.data)||void 0===t?void 0:t.message)||"Something went wrong."}}catch(e){throw console.log(e),e}}async function d(e,t){try{return await o.S.post("user/resetPassword?token=".concat(e,"&newPassword=").concat(t))}catch(e){console.log(e)}}async function u(e,t,r){try{console.log("test");let a=await o.S.put("user/updateUserProfile?userId=".concat(t),r,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"}});return console.log(a),a}catch(e){throw console.log(e),e}}async function c(e,t){try{console.log("token",e);let r=await o.S.get("user/getAllAddress?userId=".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});return console.log(r),r.data}catch(e){return console.error("Error fetching addresses:",e),{error:e.message||"Something went wrong!"}}}let p=async(e,t,r)=>{try{let a=await o.S.put("user/makePrimaryAddress",{},{params:{userId:t,addressId:r},headers:{Authorization:"Bearer ".concat(e)}});return console.log(a),a.data}catch(e){return console.error("Error fetching addresses:",e),{error:e.message||"Something went wrong!"}}},h=async(e,t,r)=>{try{let{street:a,city:s,state:n,country:i,zip:l,isPrimary:d}=r;return(await o.S.post("user/addAddress",{},{params:{userId:t,street:a,city:s,state:n,country:i,zip:l,isPrimary:d},headers:{Authorization:"Bearer ".concat(e)}})).data}catch(e){var a,s;return console.error("Error adding address:",e),{error:(null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.message)||"Something went wrong!"}}},m=async(e,t,r,a)=>{try{let{street:s,city:n,state:i,country:l,zip:d,isPrimary:u}=a;return(await o.S.put("user/editAddress",{},{params:{userId:t,addressId:r,street:s,city:n,state:i,country:l,zip:d,isPrimary:u},headers:{Authorization:"Bearer ".concat(e)}})).data}catch(e){var s,n;return console.error("Error adding address:",e),{error:(null===(n=e.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.message)||"Something went wrong!"}}},f=async(e,t,r)=>{try{return(await o.S.delete("user/deleteAddress",{params:{userId:t,addressId:r},headers:{Authorization:"Bearer ".concat(e)}})).data}catch(e){var a,s;return console.error("Error adding address:",e),{error:(null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.message)||"Something went wrong!"}}}},6301:(e,t,r)=>{r.d(t,{S:()=>s});var o=r(2651),a=r(9208);let s=o.A.create({baseURL:"https://shopflow-1-ugli.onrender.com"});s.interceptors.request.use(e=>{var t;let r=a.A.get("shopflow_session");if(!r)return e;let o=null===(t=JSON.parse(r))||void 0===t?void 0:t.token;return o&&(e.headers.Authorization="Bearer ".concat(o)),e},e=>Promise.reject(e))},9398:(e,t,r)=>{r.d(t,{dj:()=>p,oR:()=>c});var o=r(2115);let a=0,s=new Map,n=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),u({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?n(r):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function u(e){d=i(d,e),l.forEach(e=>{e(d)})}function c(e){let{...t}=e,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),o=()=>u({type:"DISMISS_TOAST",toastId:r});return u({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||o()}}}),{id:r,dismiss:o,update:e=>u({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function p(){let[e,t]=o.useState(d);return o.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:c,dismiss:e=>u({type:"DISMISS_TOAST",toastId:e})}}}}]);