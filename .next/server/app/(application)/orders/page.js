(()=>{var e={};e.id=956,e.ids=[956],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},27910:e=>{"use strict";e.exports=require("stream")},83997:e=>{"use strict";e.exports=require("tty")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},59150:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=t(70260),o=t(28203),a=t(25155),n=t.n(a),l=t(67292),i={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);t.d(r,i);let d=["",{children:["(application)",{children:["orders",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,57787)),"/home/murali/Documents/Cloning task/shopflow-current/shopflow-cpy/shopflowcpy/src/app/(application)/orders/page.js"]}]},{}]},{forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,78162))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,38934)),"/home/murali/Documents/Cloning task/shopflow-current/shopflow-cpy/shopflowcpy/src/app/layout.js"],loading:[()=>Promise.resolve().then(t.bind(t,18988)),"/home/murali/Documents/Cloning task/shopflow-current/shopflow-cpy/shopflowcpy/src/app/loading.js"],"not-found":[()=>Promise.resolve().then(t.bind(t,26420)),"/home/murali/Documents/Cloning task/shopflow-current/shopflow-cpy/shopflowcpy/src/app/not-found.js"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,78162))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/home/murali/Documents/Cloning task/shopflow-current/shopflow-cpy/shopflowcpy/src/app/(application)/orders/page.js"],u={require:t,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:o.RouteKind.APP_PAGE,page:"/(application)/orders/page",pathname:"/orders",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},51373:(e,r,t)=>{Promise.resolve().then(t.bind(t,57787))},49165:(e,r,t)=>{Promise.resolve().then(t.bind(t,67295))},67295:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var s=t(45512),o=t(58009),a=t(8766),n=t(92273);t(65357);var l=t(79334),i=t(17427);let d=({product:e,onCancel:r,cancelLoading:t})=>{let o=(0,l.useRouter)();return(0,n.wA)(),(0,s.jsxs)("div",{className:"product-card p-5 bg-white rounded-lg shadow-lg mb-4 w-full sm:w-96 lg:w-full",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-xl font-semibold text-gray-800",children:["Order ID: ",(0,s.jsxs)("span",{className:"text-gray-500",children:["#",e.orderId]})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Placed on: ",new Date(e.orderDate).toLocaleDateString()]})]}),(0,s.jsx)("p",{className:`font-semibold ${"CONFIRMED"===e.status?"text-green-600":"CANCELLED"===e.status?"text-red-600":"text-gray-600"}`,children:e.status})]}),(0,s.jsxs)("div",{onClick:()=>{o.push(`/product/${e.productId}`)},className:"flex flex-col sm:flex-row items-start space-y-4 sm:space-x-4 mb-4",children:[(0,s.jsx)("img",{src:e.image||"/_assets/image.png",alt:e.productName,className:"w-16 h-16 object-cover rounded-md border"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-semibold",children:e.productName}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["$ ",e.offerPrice.toLocaleString()," x ",e.quantity]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[(0,s.jsxs)("p",{className:"font-semibold text-lg",children:["Total: $ ",(e.offerPrice*e.quantity).toLocaleString()]}),"CANCELLED"!==e.status&&(0,s.jsx)("button",{className:`mt-3 sm:mt-0 px-4 py-2 text-white text-sm rounded ${t===e.orderId?"bg-gray-400 cursor-not-allowed":"bg-red-500 hover:bg-red-600"}`,onClick:()=>{r(e.orderId)},disabled:t===e.orderId,children:t===e.orderId?"Cancelling...":"Cancel Order"})]})]})},c=()=>{let[e,r]=(0,o.useState)([]),[t,n]=(0,o.useState)([]),[l,c]=(0,o.useState)(!0),[u,p]=(0,o.useState)(null),[m,h]=(0,o.useState)(null),[g,f]=(0,o.useState)("");(0,o.useEffect)(()=>{(async()=>{try{c(!0);let e=await (0,a.gY)(),t=e?.data;console.log(t);let s=t?.flatMap(e=>e.items.map(r=>({...r,orderDate:e.orderDate,totalAmount:e.total})));r(s||[]),n(s||[])}catch(e){p(e?.message||"An error occurred")}finally{c(!1)}})()},[]);let x=async t=>{try{h(t),await (0,a.N4)(t);let s=e.map(e=>e.orderId===t?{...e,status:"CANCELLED"}:e);r(s),n(s.filter(e=>e.productName.toLowerCase().includes(g)))}catch(e){p(e?.message||"Failed to cancel order")}finally{h(null)}};return l?(0,s.jsx)(i.a,{}):u?(0,s.jsxs)("div",{className:"text-red-500 text-center text-lg",children:["Error: ",u]}):(0,s.jsxs)("div",{className:"w-full  h-screen mx-auto p-2 md:p-4 bg-white rounded-lg shadow-md overflow-y-scroll overflow-x-hidden ",children:[(0,s.jsxs)("div",{className:"mb-6 flex flex-col sm:flex-row justify-between",children:[(0,s.jsx)("h2",{className:"text-3xl font-semibold text-gray-800 mb-6",children:"My Orders"}),(0,s.jsx)("input",{type:"text",placeholder:"Search for products in your orders",value:g,onChange:r=>{let t=r.target.value.toLowerCase();f(t),n(e.filter(e=>e.productName.toLowerCase().includes(t)))},className:"w-70 sm:w-80 h-1/5 p-3 rounded-md border border-gray-300"})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:0===t.length?(0,s.jsx)("div",{className:"col-span-full text-center text-xl font-semibold text-gray-500",children:"No orders found."}):t.map((e,r)=>(0,s.jsx)(d,{product:e,onCancel:x,cancelLoading:m},`${e.orderId}-${r}`))})]})}},17427:(e,r,t)=>{"use strict";t.d(r,{a:()=>o});var s=t(45512);t(58009);let o=()=>(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-200",children:(0,s.jsxs)("div",{className:"relative  flex items-center justify-center bg-white rounded-full shadow-2xl",children:[(0,s.jsx)("div",{className:"absolute w-full h-full border-4 border-t-transparent border-blue-500 rounded-full animate-spin"}),(0,s.jsx)("img",{src:"/_assets/loader.gif",alt:"Loading...",className:"w-24 h-24 drop-shadow-lg"})]})})},8766:(e,r,t)=>{"use strict";t.d(r,{N4:()=>d,TU:()=>l,fS:()=>o,gY:()=>i,kp:()=>a,p:()=>c,yT:()=>n});var s=t(85209);let o=async e=>{try{let r=await s.S.post("/user/order/createOrder",{items:e});return console.log(r),r.data}catch(e){throw console.error("Error creating order:",e),Error(e?.response?.data?.message||"Error creating order.")}},a=async e=>{try{return(await s.S.get(`/user/order/getOrderForCheckout/?orderId=${e}`)).data}catch(e){return console.error("Error fetching order for checkout:",e),{status:"error",message:e.response?.data?.message||"An error occurred while fetching the order."}}},n=async(e,r,t,o)=>{console.log("order_id:",e),console.log("razorpayId:",r),console.log("paymentId:",t),console.log("siign:",o);try{return(await s.S.post("/user/order/verify",{},{params:{orderId:e,razorpayId:r,paymentId:t,paymentSignature:o}})).data}catch(e){throw console.error("Error verifying payment:",e),Error(e?.response?.data?.message||"Error verifying payment.")}},l=async e=>{console.log("orderid:",e);try{return(await s.S.post(`/user/order/checkoutOrder?orderId=${e}`)).data}catch(e){throw console.error("Error fetching user orders:",e),Error(e?.response?.data?.message||"Error fetching user orders.")}},i=async()=>{try{return(await s.S.get("/user/order/getUserOrder")).data}catch(e){throw console.error("Error fetching user orders:",e),Error(e?.response?.data?.message||"Error fetching user orders.")}},d=async e=>{console.log(e);try{return(await s.S.put(`/user/order/cancelOrder?orderId=${e}`)).data}catch(e){throw console.error("Error cancelling order:",e),Error(e?.response?.data?.message||"Error cancelling order.")}},c=async e=>{console.log("userId:",e);try{let r=await s.S.get(`/user/order/getOrderById?orderId=${e}`);return console.log(r.data),r.data}catch(e){throw console.error("Error fetching user orders:",e),Error(e?.response?.data?.message||"Error fetching user orders.")}}},57787:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/murali/Documents/Cloning task/shopflow-current/shopflow-cpy/shopflowcpy/src/app/(application)/orders/page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/murali/Documents/Cloning task/shopflow-current/shopflow-cpy/shopflowcpy/src/app/(application)/orders/page.js","default")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,431,646],()=>t(59150));module.exports=s})();